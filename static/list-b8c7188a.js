import{aa as e,b as a,a as l,r as t,n as r,h as s,Y as u,j as n,w as o,i,f as d,aj as c,o as p,F as g,p as m,l as f,ak as v,C as h,al as b,y as _,ah as C,am as y,t as w,ae as k,E as z,_ as V}from"./index-dedb117b.js";import{u as P}from"./usePagination-5d39ef15.js";import{O as x}from"./order-status-tag-037bef19.js";const S=[{status:"0",means:"未确认"},{status:"1",means:"取消"},{status:"2",means:"未评价"},{status:"3",means:"完成评价"},{status:"4",means:"完成"}],T=[{status:"-1",means:"所有"},...S],j={class:"app-container"},O={class:"toolbar-wrapper"},D={class:"table-wrapper"},$={class:"pager-wrapper"},F=a({name:"ElementPlus"}),U=V(a({...F,setup(V){a({OrderStatusTag:x});const F=l(!1),U=t("http://110.41.150.2:32976/image/"),{paginationData:q,handleCurrentChange:E,handleSizeChange:I}=P(),B=l(!1),R=()=>{},A=l([]),L=a=>{k.confirm("确定删除该订单吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{var l;(l=a.id,e({url:`TbOrder/${l}`,method:"delete"})).then((e=>{e.data?(z.success("删除成功"),Z()):z.error("删除失败")}))}))},Y=e=>{A.value=e},G=()=>{const a=[];A.value.forEach((e=>{a.push(e.id)})),function(a){return e({url:"TbOrder/batch",method:"delete",params:{ids:a}})}(a.join(",")).then((e=>{e.data?(z.success("删除成功"),Z()):z.error("删除失败")}))},H=l(),J=l(S),K=t({price:[{required:!0,trigger:"blur",message:"请输入价格"}],status:[{required:!0,trigger:"blur",message:"请选择状态"}]}),M=()=>{const a={id:H.value.id,price:H.value.price,status:H.value.status};var l,t;(l=H.value.id,t=a,e({url:`TbOrder/${l}`,method:"put",data:t})).then((e=>{e.data?(B.value=!1,Z(),z.success("修改成功")):z.error("修改失败")}))},N=l([]),Q=l(null),W=l(T),X=t({status:"-1"}),Z=()=>{F.value=!0,function(a=1,l=10,t){return e({url:`TbOrder/getListAll/${a}/${l}/${t}`,method:"get"})}(q.currentPage,q.pageSize,X.status).then((e=>{N.value=e.data,q.total=e.data.length})),F.value=!1},ee=()=>{1===q.currentPage&&Z(),q.currentPage=1},ae=()=>{var e;null==(e=Q.value)||e.resetFields(),1===q.currentPage&&Z(),q.currentPage=1},le=()=>{Z()};return r([()=>q.currentPage,()=>q.pageSize],Z,{immediate:!0}),(e,a)=>{const l=d("el-option"),t=d("el-select"),r=d("el-form-item"),k=d("el-button"),z=d("el-form"),V=d("el-card"),P=d("el-tooltip"),S=d("el-table-column"),T=d("el-image"),A=d("el-table"),Z=d("el-pagination"),te=d("el-input"),re=d("el-dialog"),se=c("loading");return p(),s("div",j,[u((p(),n(V,{shadow:"never",class:"search-wrapper"},{default:o((()=>[i(z,{ref_key:"searchFormRef",ref:Q,inline:!0,model:X},{default:o((()=>[i(r,{label:"订单状态",prop:"status"},{default:o((()=>[i(t,{modelValue:X.status,"onUpdate:modelValue":a[0]||(a[0]=e=>X.status=e),class:"full-width-input",placeholder:"无",onChange:ee},{default:o((()=>[(p(!0),s(g,null,m(W.value,(e=>(p(),n(l,{key:e.status,label:e.means,value:e.status},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),i(r,null,{default:o((()=>[i(k,{type:"primary",icon:f(v),onClick:ee},{default:o((()=>[h("查询")])),_:1},8,["icon"]),i(k,{icon:f(b),onClick:ae},{default:o((()=>[h("重置")])),_:1},8,["icon"])])),_:1})])),_:1},8,["model"])])),_:1})),[[se,F.value]]),u((p(),n(V,{shadow:"never"},{default:o((()=>[_("div",O,[_("div",null,[i(k,{type:"danger",icon:f(C),onClick:G},{default:o((()=>[h("批量删除")])),_:1},8,["icon"])]),_("div",null,[i(P,{content:"刷新表格"},{default:o((()=>[i(k,{type:"primary",icon:f(y),circle:"",onClick:le},null,8,["icon"])])),_:1})])]),_("div",D,[i(A,{data:N.value,onSelectionChange:Y},{default:o((()=>[i(S,{type:"selection",width:"50",align:"center"}),i(S,{label:"订单 ID",prop:"id",align:"center"}),i(S,{label:"订单状态",align:"center"},{default:o((e=>[i(x,{status:e.row.status},null,8,["status"])])),_:1}),i(S,{label:"买家头像",align:"center"},{default:o((e=>[i(T,{type:"success",src:U+e.row.user.avatar,effect:"plain"},null,8,["src"])])),_:1}),i(S,{prop:"address.phone",label:"买家手机号",align:"center"}),i(S,{prop:"address.address",label:"买家地址",align:"center"}),i(S,{prop:"price",label:"订单价格(￥)",align:"center"}),i(S,{prop:"createDate",label:"下单时间",align:"center"}),i(S,{fixed:"right",label:"操作",width:"250",align:"center"},{default:o((e=>[i(k,{type:"primary",text:"",bg:"",size:"small",onClick:a=>{return l=e.row,H.value=l,void(B.value=!0);var l}},{default:o((()=>[h("修改")])),_:2},1032,["onClick"]),i(k,{type:"danger",text:"",bg:"",size:"small",onClick:a=>L(e.row)},{default:o((()=>[h("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])]),_("div",$,[i(Z,{background:"",layout:f(q).layout,"page-sizes":f(q).pageSizes,total:f(q).total,"page-size":f(q).pageSize,currentPage:f(q).currentPage,onSizeChange:f(I),onCurrentChange:f(E)},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])])])),_:1})),[[se,F.value]]),i(re,{modelValue:B.value,"onUpdate:modelValue":a[4]||(a[4]=e=>B.value=e),title:"修改订单",onClose:R,width:"300px"},{footer:o((()=>[i(k,{onClick:a[3]||(a[3]=e=>B.value=!1)},{default:o((()=>[h("取消")])),_:1}),i(k,{type:"primary",onClick:M},{default:o((()=>[h("确认")])),_:1})])),default:o((()=>[i(z,{ref:"editFormRef",model:H.value,rules:K,"label-width":"100px","label-position":"left"},{default:o((()=>[i(r,{label:"订单 ID"},{default:o((()=>[h(w(H.value.id),1)])),_:1}),i(r,{label:"下单时间"},{default:o((()=>[h(w(H.value.createDate),1)])),_:1}),i(r,{label:"订单价格",prop:"price"},{default:o((()=>[i(te,{modelValue:H.value.price,"onUpdate:modelValue":a[1]||(a[1]=e=>H.value.price=e),type:"number",min:"0"},{prefix:o((()=>[h(" ￥")])),_:1},8,["modelValue"])])),_:1}),i(r,{prop:"status",label:"订单状态"},{default:o((()=>[i(t,{modelValue:H.value.status,"onUpdate:modelValue":a[2]||(a[2]=e=>H.value.status=e),class:"full-width-input",placeholder:"请选择",onChange:ee},{default:o((()=>[(p(!0),s(g,null,m(J.value,(e=>(p(),n(l,{key:e.status,label:e.means,value:e.status},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-821a774a"]]);export{U as default};
